<?xml version="1.0" encoding="utf-8"?>
<ItemRenderer>
  <Data>
    <Sprite name="s_eye" fileName="game/player_cosmetics4.rttex" textureSize="32" frame="19,4"/>
    <Sprite name="s_mist" fileName="game/particles_large16.rttex" textureSize="64" frame="14,4" />
    <Sprite name="s_projectile" fileName="game/particles12.rttex" textureSize="32" frame="26,12" />

    <Animations>
      <SpriteAnimation name="a_eye" autoPlay="true" sprite="s_eye" isLoop="true" animTime="400">
        <Frame>19,4</Frame>
        <Frame>20,4</Frame>
        <Frame>21,4</Frame>
        <Frame>22,4</Frame>
      </SpriteAnimation>
    </Animations>

    <ParticleSystems>
      <ParticleSystem name="ps_mist" updateStage="AddClothingParticles" renderStage="RenderBehind">
        <Emitter>
          <Set name="offset">0, -18</Set>
          <Set name="emissionInterval">0.5</Set>
          <Set name="infParticles">true</Set>
          <Set name="infLifeTime">true</Set>
          <Set name="particlesPerEmission">1</Set>
        </Emitter>
        <Particle>
          <Set name="sprite">s_mist</Set>
          <Set name="relativeToEmitter">true</Set>
          <Set name="inSpecificOrder">true</Set>
          <Set name="blendingMode">PREMULTIPLIED_ALPHA</Set>
          <Curve name="initialAlpha">
            <KeyFrame>0, 0</KeyFrame>
            <KeyFrame>0.5, 0.5</KeyFrame>
            <KeyFrame>1, 0</KeyFrame>
          </Curve>
          <Curve name="initialScale">
            <KeyFrame>0, 0.5, 0.5</KeyFrame>
            <KeyFrame>1, 1.25, 1.25</KeyFrame>
          </Curve>
          <Set name="lifeTime">3</Set>
          <Set name="initialVelocity">0, 0</Set>
          <Random name="initialAngle" min="0" max="360" />
        </Particle>
      </ParticleSystem>
      <ParticleSystem name="ps_punchProjectile" updateStage="OnPunchUpdate">
        <Emitter attachment="targetPos">
          <Set name="lifeTime">0.5</Set>
          <Set name="emissionInterval">0.03</Set>
          <Set name="infParticles">true</Set>
          <Set name="particlesPerEmission">1</Set>
          <Set name="particlesToEmit">1</Set>
        </Emitter>
        <Particle>
          <Set name="sprite">s_projectile</Set>
          <Set name="blendingMode">PREMULTIPLIED_ALPHA</Set>
          <Set name="lifeTime">0.5</Set>
          <Set name="targetPos" source="context.pos"/>
          <Random name="offset" min="-3,-3" max="3,3" />
          <Random name="targetPosOffset" min="-4,-30" max="4,-2" />
          <VectorTo name="initialVelocity" source="targetPos" offset="targetPosOffset" duration="lifeTime" x="1"/>
          <Curve name="initialAlpha">
            <KeyFrame>0, 0.8</KeyFrame>
            <KeyFrame>0.8, 0.8</KeyFrame>
            <KeyFrame>1, 0</KeyFrame>
          </Curve>
          <Random name="initialAngle" min="0" max="360" />
          <Random name="initialScale" min="0.5" max="1" />
        </Particle>
      </ParticleSystem>
    </ParticleSystems>

    <VariableMap>
      <Set name="context.pos">0, 0</Set>
    </VariableMap>

  </Data>

  <RenderRules>
    <OnPunchUpdate>
      <AvatarTransform class="Face">
        <Set name="face">MAD</Set>
      </AvatarTransform>
      <AvatarTransform class="ArmAngle">
        <Set name="armName">arm1Angle</Set>
        <Set name="pointTowardsPunchTarget">true</Set>
      </AvatarTransform>
      <AvatarTransform class="ArmAngle">
        <Set name="armName">arm2Angle</Set>
        <Set name="armAngle">0</Set>
      </AvatarTransform>
    </OnPunchUpdate>
    <RenderFaceItem>
      <SpriteRender name="s_eye" offset="0.5,-16" alignment="DOWN_CENTER" blend="PREMULTIPLIED_ALPHA"/>
    </RenderFaceItem>
    <RenderBehind>
      <StopIf>
        <IsRenderMod>RENDER_MOD_MINI_YOU</IsRenderMod>
      </StopIf>
    </RenderBehind>
  </RenderRules>
</ItemRenderer>