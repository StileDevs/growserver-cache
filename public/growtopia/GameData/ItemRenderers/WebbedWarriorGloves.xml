<?xml version="1.0"?>
<ItemRenderer>
	<Data>
		<Sprite name="s_glove1" fileName="game/player_cosmetics3.rttex" textureSize="32" frame="27,30" />
		<Sprite name="s_glove2" fileName="game/player_cosmetics3.rttex" textureSize="32" frame="27,30" />
		<Sprite name="s_web" fileName="game/particles12.rttex" textureSize="32" frame="20,4" />
		<Sprite name="s_webRing" fileName="game/particles12.rttex" textureSize="32" frame="21,4" />
		<Animations>
			<SpriteAnimation name="a_glove_idle" sprite="s_glove2" autoPlay="true" isLoop="true" playOnState="Grip.No">
				<Frame>27,30</Frame>
			</SpriteAnimation>
			<SpriteAnimation name="a_glove_punch" sprite="s_glove2" autoPlay="true" isLoop="true" playOnState="Grip.Yes">
				<Frame>28,30</Frame>
			</SpriteAnimation>
			
		</Animations>
		<RenderOptions>
			<Default>
				<Set name="IncludeAllActions">true</Set>
				<Set name="RenderBackArmInfected">true</Set>
				<Set name="RenderFrontArmInfected">true</Set>
				<Set name="DefaultRenderMannequinHandItem">false</Set>
				<Set name="RenderBackArmInTheFront">false</Set>
			</Default>
			<Override overrideOnState="Web.Yes">
				<Set name="RenderBackArmInTheFront">true</Set>
			</Override>
		</RenderOptions>
		<ParticleSystems>
			<ParticleSystem name="ps_web">
				<Emitter attachment="targetPos">
					<Set name="particlesPerEmission">1</Set>
					<Set name="particlesToEmit">1</Set>
					<Set name="delayTimer">0.0</Set>
				</Emitter>
				<Particle>
					<Set name="lifeTime" source="web.lifetime"/>
					<Set name="sprite">s_webRing</Set>
					<Curve name="initialAlpha">
						<KeyFrame>0, 1</KeyFrame>
						<KeyFrame>0.95, 1</KeyFrame>
						<KeyFrame>1, 0</KeyFrame>
					</Curve>
				</Particle>
			</ParticleSystem>
			<ParticleSystem name="ps_webHit">
				<Emitter attachment="targetPos">
					<Set name="particlesPerEmission">1</Set>
					<Set name="particlesToEmit">1</Set>
					<Set name="checkParticleNumToEmit">true</Set>
					<Set name="delayTimer">0.0</Set>
					
				</Emitter>
				<Particle>
					<Set name="lifeTime">0.1</Set>
					<Set name="sprite">s_webRing</Set>
					<Curve name="initialAlpha">
						<KeyFrame>0, 1</KeyFrame>
						<KeyFrame>0.95, 1</KeyFrame>
						<KeyFrame>1, 0</KeyFrame>
					</Curve>
				</Particle>
			</ParticleSystem>
		</ParticleSystems>
		<StateMachines>
			<StateMachine name="Web">
				<States>
					<State name="No" />
					<State name="Yes" />
				</States>
				<Transitions>
					<Transition to="No" from="Yes">
						<Condition>
							<CompareCustomVariable operatorType="LessOrEqual" VariableNameToCompare="web.timer">0</CompareCustomVariable>
						</Condition>
					</Transition>
					<Transition to="Yes" from="No">
						<Condition>
							<CompareCustomVariable operatorType="Greater" VariableNameToCompare="web.timer">0</CompareCustomVariable>
						</Condition>
					</Transition>
				</Transitions>
			</StateMachine>
			<StateMachine name="Grip">
				<States>
					<State name="No" />
					<State name="Yes" />
				</States>
				<Transitions>
					<Transition to="No" from="Yes">
						<Condition>
							<IsAction operatorType="NotEqual">PUNCH</IsAction>
						</Condition>
					</Transition>
					<Transition to="Yes" from="No">
						<Condition>
							<IsAction>PUNCH</IsAction>
						</Condition>
					</Transition>
				</Transitions>
			</StateMachine>
		</StateMachines>
		<VariableMap>
			<Set name="web.timer">0</Set>
			<Set name="web.duration">2</Set>
			<Set name="web.lifetime">0</Set>
			<Set name="DeltaTime">0</Set>
		</VariableMap>
	</Data>
	<RenderRules>
		<Update>
			<StopIf type="or">
				<IsRenderMod>RENDER_MOD_SPIRIT_GUIDE</IsRenderMod>
				<IsRenderMod>RENDER_MOD_RAINBOW_GUY</IsRenderMod>
				<IsZombified>true</IsZombified>
				<IsSleepingOnaBed>true</IsSleepingOnaBed>
				<IsRenderMod>RENDER_MOD_MINI_YOU</IsRenderMod>
			</StopIf>
			<Group onState="Web.Yes">
				<StopIf>
					<IsAction>BUILD</IsAction>
				</StopIf>
				<AvatarTransform class="ArmAngle">
					<Set name="armName">arm1Angle</Set>
					<Set name="pointTowardsPunchTarget">true</Set>
				</AvatarTransform>
			</Group>
			<ArithmethicOperation LeftHandVariableName="web.timer" RightHandVariableName="DeltaTime" OperationType="Substract" />
		</Update>
		<RenderHandItem>	
			<SpriteRender name="s_glove1" blend="PREMULTIPLIED_ALPHA" drawShadow="true" alignment="UPPER_CENTER" />		
		</RenderHandItem>
		<RenderBehind>
			<StopIf type="or">
				<IsSitting ItemID="ITEM_ID_THEATER_SEAT">false</IsSitting>
				<IsZombified>true</IsZombified>
			</StopIf>
			<Group onState="Web.Yes">
				<Translate>0,10,0</Translate>
				<SpriteRender name="s_web" alignmentLeft="LEFT_CENTER" alignmentRight="RIGHT_CENTER" drawShadow="false" blend="PREMULTIPLIED_ALPHA" stretchToTarget="true" />
				<ParticleSystemUpdate name="ps_webHit"/>
			</Group>
		</RenderBehind>
		<RenderBackHandItem value="shoulder">
			<StopIf type="and">
				<IsAction>PUNCH</IsAction>
				<IsZombified>true</IsZombified>
			</StopIf>
			<StopIf>
				<IsAction>BUILD</IsAction>
			</StopIf>
			<SpriteRender name="s_glove2" blend="PREMULTIPLIED_ALPHA" drawShadow="true" alignment="UPPER_CENTER" />
			<StopIf>
				<IsZombified>true</IsZombified>
			</StopIf>
			<Group onState="Web.Yes">
				<Translate>0,10,0</Translate>
				<SpriteRender name="s_web" alignmentLeft="LEFT_CENTER" alignmentRight="RIGHT_CENTER" drawShadow="false" blend="PREMULTIPLIED_ALPHA" stretchToTarget="true" />
				<ParticleSystemUpdate name="ps_webHit"/>
			</Group>
		</RenderBackHandItem>
		<OnPunchStart>
			<ArithmethicOperation LeftHandVariableName="web.duration" RightHandVariableName="0.4" OperationType="Set" />
			<ArithmethicOperation LeftHandVariableName="web.lifetime" RightHandVariableName="0.4" OperationType="Set" />
			<ArithmethicOperation LeftHandVariableName="web.timer" RightHandVariableName="web.duration" OperationType="Set" />
			<ParticleSystemUpdate name="ps_web"/>
		</OnPunchStart>
		<OnPunchUpdate>
			<AvatarTransform class="Face">
				<Set name="face">MAD</Set>
			</AvatarTransform>
		</OnPunchUpdate>
		<OnDamagedTile>
			<StopIf>
				<IsZombified>true</IsZombified>
			</StopIf>
			<ArithmethicOperation LeftHandVariableName="web.duration" RightHandVariableName="2.5" OperationType="Set" />
			<ArithmethicOperation LeftHandVariableName="web.lifetime" RightHandVariableName="2.5" OperationType="Set" />
			<ArithmethicOperation LeftHandVariableName="web.timer" RightHandVariableName="web.duration" OperationType="Set" />
		</OnDamagedTile>
	</RenderRules>
</ItemRenderer>
